---
layout: post
title: dddd
description:
date: 2026-12-22
categories:
tags:
---
So i have been learning heap exploitation for the past few months, I understand a lot of exploitation techniques. 

In this blog post i want to show how to go from a use after free (UAF)/off by  to getting a shell.

## Write Targets

So which targets would we wish to overwrite?
- `__free_hook`, `__malloc_hook`
	- Removed in `glibc >= 2.34`
- Global Offset Table (GOT) overwrite
	- Requires No Full RELRO
	- 
- File Structure exploitation | FSOP
	- `_IO_list_all` -> fake `_IO_FILE`
	- Trigger
		- `exit()`, `fwrite/fread`, `_IO_flush_all_lockp`, etc
- `_rtld_global`, `_rtld_global_ro` (dynamic linker structures)
	- Target:
		- `dl_rtld_lock_recursive`
		- `dl_rtld_unlock_recursive`
		- `_dl_fini`
	- Trigger
		- `exit()`, `dlclose()`
- TLS (Thread Local Storage)
	- The TLS area contains sensitive pointers including stack canary:
		- By overwriting the master copy of the canary, you can bypass Stack canary protection.
- Heap to stack pivot exploit
	- Leak stack address, then redirect heap allocation onto the stack and overwrite a saved return address with ROP
	- Redirect allocation to the `environ-0x10` in order to leak the `environ` variable from libc. Then `*environ` points into the stack.
	- Compute the target (saved return address)
	- redirect the allocation to the target (stack saved return address)
	- Overwrite saved return address  with ROP chain.
